<img src=./image.png width=50%>

# D7 Army 04/12/22 Incident Report- Regenerate Server Keys

## Issue Summary

On November 3rd 2022(East Africa Time), our Site Reliability Engineer discovered a malicious actor had illegally gained access to an unused account with moderator access. Using this account, the actor was able to extract a limited amount of account information from registered users on our forums. In our commitment to transparency, security and your privacy we’re sharing the details leading up to this incident.

## Timeline
As you may know many members of the D7 Army team have been using element names from the periodic table as their pseudonyms. Back in 2020, we wrote a script to programmatically create forum users for each element from the periodic table. We stopped using those element account on the forums in 2019 and left them for what they are. They had a random password that no one knew so no one would be able to log in them.
- On November 3rd one of those elements accounts suddenly popped up. The attacker used a compromised element account to create a post in which they revealed to have access to account data. 
- This obviously raised alarm bells and we immediately began investigating. We soon discovered that on October 12th 2022 the attacker was able to access multiple of those element accounts. They did this by brute-forcing passwords using large amount of IP addresses to mask their attempts.
- Starting October 17th up until November 3rd, the attacker was able to scrape amount data off our forums. This happened at the rate that was unnoticeable by our metrics. Once we discovered the post created by the attacker, we disabled all element accounts to prevent further use

## Root Cause
An unused moderator account was used to scrape account data of our forums. This scraping was performed by using API which the moderator account had access to. Fortunately, this API doesn’t expose much, only limited amount of account data was accessible to the attacker. This means that no passwords could be retrieved and your account is safe. The following was exposed:
- Forum account information: Username, Email Address, IP address limited to your account at the sign up and the IP you last logged in with
- Server license keys – Since server license keys were exposed to the attacker, we will be taking measures against reuse. All server keys will be regenerated to prevent misuse and we’ll be notifying all server owners when this happens

## Resolution and recovery
We have taken the past 3 days to extensively assess the situation and take measures to prevent this from happening in the future.
1. We’ve identified the entry point and the full scope of the data breach
2. We’ve disabled all of the afore-mentioned element accounts and removed their permissions
3. We’ve audited our logs to confirm nothing else had been compromised
4. We’ve released an initial change to Keymaster to prepare for the upcoming license key

## Corrective Measures
- We are in the process of notifying all relevant Data Protection Authorities (DPA’s) of the breach
- Server license keys will be regenerated by 14th November 2022. A notification will be sent out to all relevant server owners
- Keymaster will encode license keys in our database to prevent them from being read by anyone but the server owner
- We’re changing internal security and audit policies to prevent breaches like these from happening again

